<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Korex StyleHub</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Korex StyleHub" name="keywords">
    <meta content="Korex StyleHub" name="description">

    <!-- Favicon -->
    <link href="../img/logo.PNG" rel="icon"> 

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet"> 

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="../lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

   <!-- Customized Bootstrap Stylesheet -->
   <link href="../css/style.css" rel="stylesheet">
   <link href="../css/landingPage.css" rel="stylesheet">

   <script src="https://js.paystack.co/v1/inline.js"></script> 
</head>

<body>
   
   
    <!-- Navbar Start -->
                <%- include (`../partials/userShopHeader`); -%>
    <!-- Navbar End -->

    <!-- Page Header Start -->
    <div class="container-fluid bg-secondary mb-5">
        <div class="d-flex flex-column align-items-center justify-content-center" style="min-height: 300px">
            <h1 class="font-weight-semi-bold text-uppercase mb-3">Checkout</h1>
            <div class="d-inline-flex">
                <p class="m-0"><a href="/user/index">Home</a></p>
                <p class="m-0 px-2">-</p>
                <p class="m-0">Checkout</p>
            </div>
        </div>
    </div>
    <!-- Page Header End -->

    <!-- Checkout Start -->
    <div class="container-fluid">
        <div class="row px-xl-5">
            <form action="initializeTrans/<%- user._id %>" method="post">
                 <!-- Hidden input field for user ID -->
                <input type="hidden" name="userId" value="<%- user._id %>">
                <div class="col-lg-8">
                    <h5 class="section-title position-relative text-uppercase mb-3"><span class="bg-secondary pr-3">Billing Address</span></h5>
                    <div class="bg-light p-30 mb-5">
                        <div class="row">
                            <div class="col-md-6 form-group">
                                <input type="hidden" id="userId" value="<%- user._id %>">
                                <label>First Name</label> 
                                <input class="form-control" type="text" name="userFirstName" value="<%- user.userFirstName %>" readonly>
                            </div>
                            <div class="col-md-6 form-group">
                                <label>Last Name</label>
                                <input class="form-control" type="text" name="userLastName" value="<%- user.userLastName %>" readonly>
                            </div>
                            <div class="col-md-6 form-group">
                                <label>E-mail</label>
                                <input class="form-control" id="userEmail" type="email" name="userEmail" value="<%- user.userEmail %>" readonly>
                            </div>
                            <div class="col-md-6 form-group">
                                <label>Mobile No</label>
                                <input class="form-control" type="text" name="userNumber" value="<%- user.userNumber %>" readonly>
                            </div>
                            <div class="col-md-6 form-group">
                                <label>Address</label>
                                <input class="form-control" type="text" name="userAddress" value="<%- user.userAddress %>" readonly>
                            </div>
                            <div class="col-md-6 form-group">
                                <label>City</label>
                                <input class="form-control" type="text" name="userCity" value="<%- user.userCity %>" readonly>
                            </div>
                            <div class="col-md-6 form-group">
                                <label>State</label>
                                <input class="form-control" type="text" name="userState" value="<%- user.userState %>" readonly>
                            </div>
                            <div class="col-md-6 form-group">
                                <label>Country</label>
                                <input class="form-control" type="text" name="userCountry" value="<%- user.userCountry %>" readonly>
                            </div>
    
                            <div class="col-md-12" id="shipto-container" style="display: none;">
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" class="custom-control-input" id="shipto">
                                    <label class="custom-control-label" for="shipto"  data-toggle="collapse" data-target="#shipping-address">Ship to different address</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="collapse mb-5" id="shipping-address">
                        <h5 class="section-title position-relative text-uppercase mb-3"><span class="bg-secondary pr-3">Shipping Address</span></h5>
                        <div class="bg-light p-30">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <label>First Name</label>
                                    <input class="form-control" type="text" name="receiverFirstName" value="<%- user.userFirstName %>" >
                                </div>
                                <div class="col-md-6 form-group">
                                    <label>Last Name</label>
                                    <input class="form-control" type="text" name="receiverLastName"  value="<%- user.userLastName %>" >
                                </div>
                                <div class="col-md-6 form-group">
                                    <label>E-mail</label>
                                    <input class="form-control" type="text" name="receiverEmail" value="<%- user.userEmail %>">
                                </div>
                                <div class="col-md-6 form-group">
                                    <label>Mobile No</label>
                                    <input class="form-control" type="text" name="receiverNumber" value="<%- user.userNumber %>">
                                </div>
                                <div class="col-md-6 form-group">
                                    <label>Address Line 1</label>
                                    <input class="form-control" type="text" name="receiverAddress"  value="<%- user.userAddress %>">
                                </div>
                               
                                <div class="col-md-6 form-group">
                                    <label>City</label>
                                    <input class="form-control" type="text" name="receiverCity" value="<%- user.userCity %>">
                                </div>
                                <div class="col-md-6 form-group">
                                    <label>State</label>
                                    <input class="form-control" type="text" name="receiverState" value="<%- user.userState %>">
                                </div>
                                <div class="col-md-6 form-group">
                                    <% const countries = [
                                    "Nigeria", "Ã…land Islands", "Albania", "Bangladesh", "Barbados", "Belarus", "Belgium","French Southern Territories", "Gabon", "Gambia", "Georgia", "Germany", "Ghana", "Gibraltar", "Greece", "Greenland", "Grenada", "Guadeloupe", "Guam", "Guatemala", "Guernsey", "Guinea",  "Honduras", "Hong Kong", "Hungary", "Iceland", "India", "Indonesia", "Iran, Islamic Republic of", "Iraq", "Ireland", "Isle of Man", "Israel", "Italy", "Jamaica", "Japan", "Jersey", "Jordan", "Kazakhstan", "Kenya", "Kiribati", "Korea, Democratic People's Republic of", "Korea, Republic of", "Kuwait", "Kyrgyzstan", "United States", "United States Minor Outlying Islands", "Uruguay", "Uzbekistan", "Vanuatu", "Venezuela", "Viet Nam", "Virgin Islands, British", "Virgin Islands, U.S.", "Wallis and Futuna", "Western Sahara", "Yemen", "Zambia", "Zimbabwe"]; %>
                                    <label>Country</label>
                                    <select class="custom-select" name="receiverCountry">
                                        <option value="">Select Country</option>
                                        <% countries.forEach((country) => { %>
                                            <% if (country === "Nigeria") { %>
                                                <option value="<%- country %>" selected><%- country %></option>
                                            <% } else { %>
                                                    <option value="<%- country %>"><%- country %></option>
                                                <% } %>
                                        <% }) %>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <h5 class="section-title position-relative text-uppercase mb-3"><span class="bg-secondary pr-3">Order Total</span></h5>
                    <div class="bg-light p-30 mb-5">
                        <div class="border-bottom">
                            <h6 class="mb-3">Products</h6>
                            <div class="product-list-container" style="max-height: 150px; overflow-y: auto;">
                                <% cartItems.forEach(product => { %>
                                    <div class="border-bottom">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <% if (product.images && product.images.length > 0) { %>
                                                    <img src="<%= product.images[0].imageUrl %>" alt="product Image" style="width: 50px;">
                                                <% } else { %>
                                                    NA
                                                <% } %>
                                                <span id="productName"><%= product.productName %></span> 
                                                <span id="productQuantity">Qty: <%= product.quantity %></span>
                                                <input type="hidden" id="productID" value="<%= product._id %>">
                                                <div>
                                                    <span id="productColor">Col: <%= product.selectedColor %></span> 
                                                    <span id="productSize">Size: <%= product.selectedSize %></span>
                                                </div> 
                                            </div>
                                            <p>$<%= product.productTotalAmount ? product.productTotalAmount.toFixed(2) : product.productPrice %></p>
                                        </div>
                                    </div>
                                <% }); %>
                            </div>
                        </div>
                        <div class="border-bottom pt-3 pb-2 ">
                            <div class="d-flex justify-content-between mb-3 Subtotal">
                                <h6>Subtotal</h6>
                                <h6><p>$<%= subtotal.toFixed(2) %></p></h6>
                            </div>
                            <div class="d-flex justify-content-between totalShipping">
                                <h6 class="font-weight-medium">Shipping</h6>
                                <h6 class="font-weight-medium">$<%= totalShipping.toFixed(2) %></h6>
                            </div>
                        </div>
                        <div class="pt-2"> 
                            <div class="d-flex justify-content-between mt-2 totalAmount">
                                <h5>Total</h5>
                                <h5 id="totalAmount">$<%= totalAmount.toFixed(2) %></h5>
                            </div>
                        </div>
                    </div>
                    <div class="mb-5">
                        <h5 class="section-title position-relative text-uppercase mb-3"><span class="bg-secondary pr-3" id="payment-section">Payment</span></h5>
                        <div class="bg-light p-30">
                            <span id="card-section">
                                <div class="form-group">
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input" name="payment" id="debitcard">
                                        <label class="custom-control-label" for="debitcard">Debit Card</label>
                                    </div>
                                </div>
                            </span>
                            <button id="placeOrderButton" type="button" class="btn btn-block btn-primary font-weight-bold py-3">Place Order</button>

                            <button id="submitOrderButton" type="submit" class="btn btn-block btn-primary font-weight-bold py-3" style="display: none;">Submit Order</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <!-- Checkout End -->


    <!-- Footer Start -->
    <%- include (`../partials/userFooter`); -%>
      <!-- Footer End -->
      
</body>

</html>